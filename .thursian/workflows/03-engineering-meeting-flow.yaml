name: thursian-engineering-meeting-flow
description: >
  Engineering round table discussion to transform user-validated vision into
  a comprehensive Product Requirements Document (PRD). Domain experts, architects,
  product managers, and analysts collaborate while parallel research identifies
  existing solutions, gaps, and leverageable technologies.

version: 1.0.0

memory:
  backend: agentdb
  namespaces:
    focus-groups: focus-group-synthesis
    engineering-personas: engineering-personas
    engineering-discussions: engineering-discussions
    technical-research: technical-research
    prds: product-requirements

input:
  type: file
  path_template: .thursian/projects/{project-name}/focus-groups/report.md
  format: markdown
  handoff_from: 02-focus-group-flow.yaml

agents:

  - id: technical_lead
    role: facilitator_and_architect
    persona_file: .thursian/personas/ideation/doer.md
    tools: [memory.read, memory.write, web.search]
    config:
      style: technical_facilitator
      focuses_on: [feasibility, architecture, technical_risks, scalability]
      expertise: [system_design, technology_selection, technical_tradeoffs]

  - id: domain_expert
    role: subject_matter_expert
    persona_template: dynamic
    tools: [memory.read, memory.write]
    config:
      adapts_to_domain: true
      expertise_level: professional
      focuses_on: [domain_patterns, best_practices, common_pitfalls, industry_standards]

  - id: product_manager
    role: business_and_product
    persona_file: .thursian/personas/engineering/product-manager.md
    tools: [memory.read, memory.write]
    config:
      focuses_on: [requirements, prioritization, roadmap, success_metrics]
      expertise: [product_strategy, feature_scoping, stakeholder_management]

  - id: marketing_analyst
    role: market_and_gtm
    persona_file: .thursian/personas/engineering/marketing-analyst.md
    tools: [memory.read, memory.write, web.search]
    config:
      focuses_on: [market_positioning, competitive_landscape, differentiation, gtm_strategy]
      expertise: [market_analysis, positioning, pricing, customer_acquisition]

  - id: ux_lead
    role: user_experience_design
    persona_file: .thursian/personas/engineering/ux-lead.md
    tools: [memory.read, memory.write]
    config:
      focuses_on: [user_flows, interaction_design, accessibility, usability]
      expertise: [ux_patterns, design_systems, user_research, prototyping]

  - id: technical_researcher
    role: technical_research_specialist
    persona_file: .thursian/personas/engineering/technical-researcher.md
    tools: [web.search, web.scrape, memory.read, memory.write]
    config:
      sources: [github, npm, pypi, stackoverflow, technical_blogs, api_docs]
      analysis_focus: [existing_solutions, open_source_libraries, market_saturation, technical_gaps]
      runs_parallel: true

  - id: prd_writer
    role: documentarian
    persona_file: .thursian/personas/ideation/synthesizer.md
    tools: [memory.read, filesystem.write]
    output_contract:
      - type: conversation_transcript
        format: markdown
        path_template: .thursian/projects/{project-name}/03-{project-name}-engineering-full.md
        description: "Complete engineering meeting discussion with all 5 rounds"
      - type: prd_inline
        format: markdown
        path_template: .thursian/projects/{project-name}/03-{project-name}-prd.md
        description: "Product Requirements Document (historical inline version)"
      - type: prd_design_doc
        format: markdown
        path_template: .thursian/projects/{project-name}/design-docs/PRD.md
        description: "Product Requirements Document (official design doc)"

# Domain-specific engineering persona templates
engineering_personas:

  gaming:
    domain_expert:
      type: game_designer_engineer
      expertise: [game_mechanics, player_psychology, monetization, retention, game_engines]
      experience: [shipped_titles, platform_expertise, analytics, live_ops]
      concerns: [engagement_metrics, churn, technical_performance, platform_compliance]

  productivity:
    domain_expert:
      type: productivity_systems_architect
      expertise: [workflow_optimization, collaboration_patterns, data_sync, offline_first]
      experience: [enterprise_saas, productivity_tools, integration_platforms]
      concerns: [adoption, data_security, performance, cross_platform]

  automation:
    domain_expert:
      type: automation_platform_architect
      expertise: [workflow_engines, rpa, integration_patterns, orchestration]
      experience: [enterprise_automation, api_design, event_driven_systems]
      concerns: [reliability, error_handling, monitoring, scalability]

  developer_tools:
    domain_expert:
      type: developer_tools_engineer
      expertise: [dx, build_systems, language_servers, debugging, performance]
      experience: [ides, cli_tools, developer_platforms, extension_systems]
      concerns: [developer_experience, performance, ecosystem_fit, adoption]

  mobile_apps:
    domain_expert:
      type: mobile_platform_architect
      expertise: [ios, android, react_native, flutter, offline_sync, performance]
      experience: [app_store_optimization, mobile_patterns, native_apis]
      concerns: [app_size, battery_life, platform_guidelines, review_process]

  web_apps:
    domain_expert:
      type: web_platform_architect
      expertise: [spa, pwa, ssr, performance, accessibility, seo]
      experience: [modern_frameworks, state_management, api_design, hosting]
      concerns: [browser_compatibility, performance, seo, security]

workflow:

  entry_state: initialize
  exit_states: [complete]

  states:

    initialize:
      agent: technical_lead
      description: "Load focus group report, detect domain, prepare engineering team"
      actions:
        - type: filesystem.read
          path_from_input: focus_group_path
        - type: analyze_focus_group
          extract: [domain, validated_features, user_pain_points, must_haves, deal_breakers, market_size]
        - type: detect_engineering_domain
          based_on: primary_domain
        - type: generate_engineering_personas
          count: 5
          roles: [domain_expert, product_manager, marketing_analyst, ux_lead, technical_lead]
        - type: memory.write
          namespace: engineering-personas
          key: persona_specifications
        - type: memory.write
          namespace: focus-groups
          key_from: idea_id
        - type: create_meeting_agenda
      transitions:
        on_success: initialize_technical_research

    initialize_technical_research:
      agent: technical_researcher
      description: "Launch parallel technical research: existing solutions, libraries, market gaps"
      parallel: true
      actions:
        - type: web.search
          queries:
            - "{domain} existing solutions alternatives 2024"
            - "{domain} open source libraries frameworks"
            - "{primary_feature} github repositories stars"
            - "{domain} market saturation analysis"
            - "{primary_feature} npm packages / pypi / maven"
            - "{domain} technical stack recommendations"
        - type: analyze_existing_solutions
          sources: [product_hunt, github, crunchbase, g2, capterra]
          identify: [features, tech_stack, pricing, user_count, gaps]
        - type: analyze_libraries
          sources: [github, npm, pypi, maven, crates.io]
          identify: [popular_libraries, use_cases, maintenance_status, licenses]
        - type: saturation_analysis
          metrics: [competitor_count, funding_levels, market_maturity, differentiation_difficulty]
        - type: memory.write
          namespace: technical-research
          key: initial_research
      transitions:
        on_success: round_1_technical_feasibility
      continues_during: [round_1_technical_feasibility, round_2_market_landscape, round_3_requirements, round_4_dependencies, round_5_success_criteria]

    round_1_technical_feasibility:
      description: "Round 1: Technical feasibility and high-level architecture"
      parallel_agents: [technical_lead, domain_expert, product_manager, marketing_analyst, ux_lead]

      technical_lead:
        actions:
          - type: introduce_meeting
            message: "Thanks for joining. We've validated user demand through focus groups. Now we need to determine what to build and ensure it's technically feasible. Let me share the focus group findings..."
          - type: present_focus_group_summary
            highlight: [must_have_features, deal_breakers, market_validation]
          - type: ask_question
            question: "From a technical standpoint, what's feasible here? What are the big architectural challenges we need to address?"
          - type: moderate_discussion
          - type: memory.write
            namespace: engineering-discussions
            key: round_1_technical_lead

      domain_expert:
        actions:
          - type: analyze_from_domain_perspective
          - type: respond
            focus: [domain_patterns, technical_challenges, best_practices, common_mistakes]
            style: expert_pragmatic
          - type: memory.write
            namespace: engineering-discussions
            key: round_1_domain_expert

      product_manager:
        actions:
          - type: analyze_from_product_perspective
          - type: respond
            focus: [feature_feasibility, mvp_scope, phasing, dependencies]
            style: product_focused
          - type: memory.write
            namespace: engineering-discussions
            key: round_1_product_manager

      marketing_analyst:
        actions:
          - type: analyze_from_market_perspective
          - type: respond
            focus: [competitive_positioning, differentiation, time_to_market]
            style: market_aware
          - type: memory.write
            namespace: engineering-discussions
            key: round_1_marketing_analyst

      ux_lead:
        actions:
          - type: analyze_from_ux_perspective
          - type: respond
            focus: [user_flows, interaction_patterns, accessibility, platform_guidelines]
            style: user_centered
          - type: memory.write
            namespace: engineering-discussions
            key: round_1_ux_lead

      transitions:
        on_complete: research_alignment_1

    research_alignment_1:
      agent: technical_researcher
      description: "Align Round 1 discussion with technical research findings"
      actions:
        - type: memory.read
          namespace: engineering-discussions
          scope: round_1
        - type: memory.read
          namespace: technical-research
          scope: initial_research
        - type: compare_and_align
          discussion_points: round_1_discussions
          research_data: technical_findings
          identify: [validated_approaches, risky_assumptions, missing_considerations]
        - type: provide_technical_evidence
          for_each: [architecture_decision, technology_choice, feasibility_claim]
        - type: memory.write
          namespace: technical-research
          key: round_1_alignment
      transitions:
        on_success: round_2_market_landscape

    round_2_market_landscape:
      description: "Round 2: Competitive analysis and market positioning"
      parallel_agents: [technical_lead, domain_expert, product_manager, marketing_analyst, ux_lead]

      technical_lead:
        actions:
          - type: review_round_1
            highlight: [architecture_direction, key_technical_decisions]
          - type: ask_question
            question: "What already exists in this space? Where are the gaps? What can we leverage versus build from scratch?"
          - type: moderate_discussion
          - type: memory.write
            namespace: engineering-discussions
            key: round_2_technical_lead

      domain_expert:
        actions:
          - type: respond
            focus: [existing_solutions, industry_standards, reusable_patterns, libraries_to_leverage]
            style: expert_pragmatic
          - type: memory.write
            namespace: engineering-discussions
            key: round_2_domain_expert

      product_manager:
        actions:
          - type: respond
            focus: [competitive_feature_matrix, differentiation_strategy, build_vs_buy]
            style: product_focused
          - type: memory.write
            namespace: engineering-discussions
            key: round_2_product_manager

      marketing_analyst:
        actions:
          - type: respond
            focus: [market_saturation, positioning, pricing_landscape, go_to_market]
            style: market_aware
          - type: memory.write
            namespace: engineering-discussions
            key: round_2_marketing_analyst

      ux_lead:
        actions:
          - type: respond
            focus: [ux_patterns_in_space, design_system_options, competitor_ux_analysis]
            style: user_centered
          - type: memory.write
            namespace: engineering-discussions
            key: round_2_ux_lead

      transitions:
        on_complete: research_alignment_2

    research_alignment_2:
      agent: technical_researcher
      description: "Deep technical research: libraries, frameworks, and saturation analysis"
      actions:
        - type: memory.read
          namespace: engineering-discussions
          scope: round_2
        - type: web.search
          queries:
            - "{domain} technical stack best practices 2024"
            - "{primary_feature} open source implementations"
            - "{domain} api integrations third party services"
            - "{domain} market leaders feature comparison"
            - "{domain} venture funding trends"
        - type: analyze_libraries_deep
          for_each_component: [search, offline_sync, ui_framework, backend, database]
          identify: [recommended_libraries, pros_cons, community_health, license_compatibility]
        - type: saturation_deep_dive
          analyze: [competitor_count, funding_total, market_growth_rate, barriers_to_entry]
        - type: gap_analysis
          compare: [what_exists, what_users_want, differentiation_opportunities]
        - type: compare_and_align
        - type: memory.write
          namespace: technical-research
          key: round_2_alignment
      transitions:
        on_success: round_3_requirements

    round_3_requirements:
      description: "Round 3: Core requirements and feature prioritization (the WHAT)"
      parallel_agents: [technical_lead, domain_expert, product_manager, marketing_analyst, ux_lead]

      technical_lead:
        actions:
          - type: review_rounds
            highlight: [feasibility_conclusions, leverage_opportunities]
          - type: ask_question
            question: "Let's define WHAT we're building. What are the core requirements? How do we prioritize features for MVP versus future phases?"
          - type: moderate_discussion
          - type: memory.write
            namespace: engineering-discussions
            key: round_3_technical_lead

      domain_expert:
        actions:
          - type: respond
            focus: [technical_requirements, performance_requirements, domain_specific_constraints]
            style: expert_pragmatic
          - type: memory.write
            namespace: engineering-discussions
            key: round_3_domain_expert

      product_manager:
        actions:
          - type: respond
            focus: [functional_requirements, user_stories, mvp_definition, release_criteria]
            style: product_focused
            create: [requirement_list, prioritization_framework]
          - type: memory.write
            namespace: engineering-discussions
            key: round_3_product_manager

      marketing_analyst:
        actions:
          - type: respond
            focus: [market_requirements, competitive_parity, differentiation_features, pricing_tiers]
            style: market_aware
          - type: memory.write
            namespace: engineering-discussions
            key: round_3_marketing_analyst

      ux_lead:
        actions:
          - type: respond
            focus: [ux_requirements, accessibility_requirements, platform_requirements, design_principles]
            style: user_centered
          - type: memory.write
            namespace: engineering-discussions
            key: round_3_ux_lead

      transitions:
        on_complete: research_alignment_3

    research_alignment_3:
      agent: technical_researcher
      description: "Requirements validation: feature benchmarking and feasibility checks"
      actions:
        - type: memory.read
          namespace: engineering-discussions
          scope: round_3
        - type: web.search
          queries:
            - "{feature_1} implementation complexity benchmarks"
            - "{feature_2} library support and maturity"
            - "{domain} mvp feature sets successful products"
            - "{performance_requirement} technical feasibility examples"
        - type: benchmark_requirements
          for_each_requirement: validate_with_real_implementations
        - type: identify_technical_risks
          for_each: [requirement, constraint, performance_target]
        - type: compare_and_align
          identify: [realistic_requirements, risky_requirements, well_supported_requirements]
        - type: memory.write
          namespace: technical-research
          key: round_3_alignment
      transitions:
        on_success: round_4_dependencies

    round_4_dependencies:
      description: "Round 4: Technical dependencies, risks, and constraints"
      parallel_agents: [technical_lead, domain_expert, product_manager, marketing_analyst, ux_lead]

      technical_lead:
        actions:
          - type: review_rounds
            highlight: [defined_requirements, prioritization]
          - type: ask_question
            question: "What dependencies, risks, and constraints do we need to account for? What could block us or require additional resources?"
          - type: moderate_discussion
          - type: memory.write
            namespace: engineering-discussions
            key: round_4_technical_lead

      domain_expert:
        actions:
          - type: respond
            focus: [technical_dependencies, third_party_services, platform_constraints, technical_risks]
            style: expert_pragmatic
          - type: memory.write
            namespace: engineering-discussions
            key: round_4_domain_expert

      product_manager:
        actions:
          - type: respond
            focus: [product_risks, resource_dependencies, timeline_constraints, stakeholder_dependencies]
            style: product_focused
          - type: memory.write
            namespace: engineering-discussions
            key: round_4_product_manager

      marketing_analyst:
        actions:
          - type: respond
            focus: [market_risks, competitive_timing, positioning_constraints, pricing_dependencies]
            style: market_aware
          - type: memory.write
            namespace: engineering-discussions
            key: round_4_marketing_analyst

      ux_lead:
        actions:
          - type: respond
            focus: [design_dependencies, platform_constraints, accessibility_requirements, user_research_needs]
            style: user_centered
          - type: memory.write
            namespace: engineering-discussions
            key: round_4_ux_lead

      transitions:
        on_complete: research_alignment_4

    research_alignment_4:
      agent: technical_researcher
      description: "Risk analysis: validate dependencies and identify mitigation strategies"
      actions:
        - type: memory.read
          namespace: engineering-discussions
          scope: round_4
        - type: web.search
          queries:
            - "{third_party_service} reliability uptime reviews"
            - "{technical_dependency} maintenance status roadmap"
            - "{platform_constraint} workarounds solutions"
            - "{domain} common technical pitfalls failures"
        - type: validate_dependencies
          for_each: [library, service, platform]
          check: [maintenance_status, community_health, alternatives]
        - type: risk_assessment
          for_each_risk: [likelihood, impact, mitigation_options]
        - type: compare_and_align
          identify: [validated_risks, underestimated_risks, mitigation_strategies]
        - type: memory.write
          namespace: technical-research
          key: round_4_alignment
      transitions:
        on_success: round_5_success_criteria

    round_5_success_criteria:
      description: "Round 5: Success metrics and launch criteria"
      parallel_agents: [technical_lead, domain_expert, product_manager, marketing_analyst, ux_lead]

      technical_lead:
        actions:
          - type: review_all_rounds
            summarize: [requirements, architecture, dependencies, risks]
          - type: ask_question
            question: "How do we measure success? What are our launch criteria and key metrics? What does 'good enough' look like for MVP?"
          - type: moderate_discussion
          - type: memory.write
            namespace: engineering-discussions
            key: round_5_technical_lead

      domain_expert:
        actions:
          - type: respond
            focus: [technical_metrics, performance_targets, quality_criteria, launch_readiness]
            style: expert_pragmatic
          - type: memory.write
            namespace: engineering-discussions
            key: round_5_domain_expert

      product_manager:
        actions:
          - type: respond
            focus: [success_metrics, kpis, launch_criteria, mvp_definition, roadmap_phases]
            style: product_focused
          - type: memory.write
            namespace: engineering-discussions
            key: round_5_product_manager

      marketing_analyst:
        actions:
          - type: respond
            focus: [market_metrics, acquisition_targets, revenue_goals, positioning_success]
            style: market_aware
          - type: memory.write
            namespace: engineering-discussions
            key: round_5_marketing_analyst

      ux_lead:
        actions:
          - type: respond
            focus: [ux_metrics, usability_criteria, accessibility_standards, user_satisfaction_targets]
            style: user_centered
          - type: memory.write
            namespace: engineering-discussions
            key: round_5_ux_lead

      transitions:
        on_complete: research_alignment_5

    research_alignment_5:
      agent: technical_researcher
      description: "Final synthesis: industry benchmarks and success patterns"
      actions:
        - type: memory.read
          namespace: engineering-discussions
          scope: round_5
        - type: memory.read
          namespace: technical-research
          scope: all_rounds
        - type: web.search
          queries:
            - "{domain} successful product metrics benchmarks"
            - "{domain} mvp launch best practices"
            - "{domain} kpi standards industry averages"
            - "{similar_product} success metrics case study"
        - type: benchmark_success_criteria
          against: [industry_standards, successful_products, market_leaders]
        - type: synthesize_research
          all_sources: true
          create: comprehensive_technical_report
        - type: compare_and_align
          identify: [realistic_targets, ambitious_targets, industry_benchmarks]
        - type: memory.write
          namespace: technical-research
          key: final_synthesis
      transitions:
        on_success: synthesize_prd

    synthesize_prd:
      agent: prd_writer
      description: "Create conversation transcript and PRD documents"
      actions:
        - type: memory.read
          namespace: engineering-discussions
          scope: all_rounds
        - type: memory.read
          namespace: technical-research
          scope: all_alignments
        - type: memory.read
          namespace: focus-groups
          scope: user_insights
        - type: memory.read
          namespace: engineering-personas
          scope: all_specifications
        - type: export_conversation
          format: full_transcript
          include: [all_rounds, agent_names, research_alignment_notes, timestamps]
        - type: filesystem.write
          path_template: .thursian/projects/{project-name}/03-{project-name}-engineering-full.md
        - type: synthesize
          format: product_requirements_document
          sections:
            - document_info:
                - product_name
                - version
                - date
                - authors
                - stakeholders
            - executive_summary:
                - product_vision
                - business_opportunity
                - success_criteria
            - problem_statement:
                - user_problems
                - market_gap
                - solution_overview
            - user_personas:
                - from_focus_group
                - user_needs
                - pain_points
            - product_requirements:
                - functional_requirements:
                    - must_have_mvp
                    - should_have_post_mvp
                    - could_have_future
                - non_functional_requirements:
                    - performance
                    - security
                    - scalability
                    - accessibility
                - technical_constraints
            - success_metrics:
                - kpis
                - launch_criteria
                - performance_targets
            - competitive_analysis:
                - existing_solutions
                - differentiation
                - market_positioning
            - technical_considerations:
                - high_level_architecture
                - key_technologies
                - third_party_dependencies
                - open_source_opportunities
            - risks_and_mitigations:
                - technical_risks
                - market_risks
                - resource_risks
                - mitigation_strategies
            - out_of_scope:
                - explicitly_excluded
                - future_considerations
            - timeline_and_phases:
                - mvp_scope
                - post_mvp_roadmap
                - key_milestones
            - appendix:
                - research_sources
                - technical_research_summary
                - focus_group_insights
                - competitive_matrix
        - type: filesystem.write
          path_template: .thursian/projects/{project-name}/03-{project-name}-prd.md
          note: "Historical inline version"
        - type: filesystem.write
          path_template: .thursian/projects/{project-name}/design-docs/PRD.md
          note: "Official design document"
        - type: memory.write
          namespace: prds
          key_from: idea_id
      transitions:
        on_success: technical_lead_summary

    technical_lead_summary:
      agent: technical_lead
      description: "Technical Lead provides final summary and handoff"
      actions:
        - type: declare
          message: "Excellent discussion team. We've validated technical feasibility, identified what to build, and created a comprehensive PRD. The WHAT is clear. Next step: detailed technical design for the HOW."
        - type: create_handoff
          next_phase: technical_design
          artifacts: [prd, technical_research, competitive_analysis]
          ready_for: [architecture_design, technical_specification, implementation_planning]
      transitions:
        on_success: complete

    complete:
      description: "Engineering meeting complete, PRD ready for stakeholder review phase"
      final: true
      handoff:
        next_workflow: 04-stakeholder-review-flow.yaml
        artifacts:
          - product_requirements_document
          - technical_research_report
          - competitive_analysis
        status: ready
        context:
          technically_validated: true
          requirements_defined: true
          ready_for_how: true
